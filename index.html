<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TravelEase - Flight Booking</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom corporate colors and gradients based on friend's design */
        :root {
            --color-primary-blue: #3B82F6; /* Tailwind blue-500 */
            --color-secondary-blue: #60A5FA; /* Tailwind blue-400 */
            --color-gradient-start: #3b82f6; /* Blue for hero/buttons */
            --color-gradient-end: #60a5fa;   /* Lighter blue for hero/buttons */
            --color-header-bg: #1a202c; /* Dark gray, might adjust to match friend's header more closely */
            --color-text-dark: #1f2937; /* gray-800 */
            --color-text-light: #f9fafb; /* gray-50 */
            --color-bg-light: #f3f4f6; /* gray-100 */
            --color-card-bg: #ffffff;
            --color-green-check: #10B981; /* green-500 */
            --color-red-cancel: #EF4444; /* red-500 */
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-bg-light);
        }
        .container {
            max-width: 1200px;
        }

        /* Gradient Button & Card Backgrounds */
        .gradient-bg-blue {
            background: linear-gradient(to right, var(--color-gradient-start), var(--color-gradient-end));
        }
        .gradient-card-purple {
            background: linear-gradient(to right top, #8B5CF6, #EC4899); /* Purple to Pink */
        }
        .gradient-card-red {
            background: linear-gradient(to right top, #EF4444, #F59E0B); /* Red to Orange */
        }
        .gradient-card-teal {
            background: linear-gradient(to right top, #14B8A6, #06B6D4); /* Teal to Cyan */
        }
        
        /* Header */
        .main-header {
            background-color: var(--color-gradient-start); /* Using primary blue for header bg */
        }
        .header-text-links a {
            color: var(--color-text-light); /* White for links */
            transition: color 0.2s;
        }
        .header-text-links a:hover {
            color: #bfdbfe; /* blue-200 */
        }

        /* Buttons */
        .btn-blue-gradient {
            background: linear-gradient(to right, var(--color-gradient-start), var(--color-gradient-end));
            color: #fff;
            font-weight: bold;
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            padding-left: 2rem;
            padding-right: 2rem;
            border-radius: 9999px;
            box-shadow: 0 10px 15px -3px rgba(59,130,246,0.1), 0 4px 6px -4px rgba(59,130,246,0.1);
            transition: box-shadow 0.3s;
        }
        .btn-blue-gradient:hover {
            box-shadow: 0 20px 25px -5px rgba(59,130,246,0.15), 0 8px 10px -6px rgba(59,130,246,0.15);
        }
        .btn-modify-search { /* New button style for modify search */
            background: #fff;
            color: #2563eb;
            font-weight: 600;
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
            padding-left: 1.5rem;
            padding-right: 1.5rem;
            border-radius: 9999px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            transition: background-color 0.2s;
        }
        .btn-modify-search:hover {
            background: #f3f4f6;
        }

        /* Card styles from friend's design */
        .feature-card {
            background: #fff;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        .destination-card {
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -4px rgba(0,0,0,0.1);
            color: #fff;
        }
        .destination-card h4 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        .flight-item-card {
            background: #fff;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: flex-start;
        }
        @media (min-width: 768px) {
            .flight-item-card {
                flex-direction: row;
                align-items: center;
            }
        }
        .seat-class-option {
            background: #fff;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            cursor: pointer;
            transition: box-shadow 0.2s;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }
        .seat-class-option:hover {
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.15), 0 4px 6px -4px rgba(0,0,0,0.12);
        }
        .seat-class-option input[type="radio"] {
             /* Custom radio button appearance matching friend's design */
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 1.5rem;
            height: 1.5rem;
            border: 2px solid #a0aec0; /* gray-400 */
            border-radius: 50%;
            background-color: white;
            transition: all 0.2s ease-in-out;
            flex-shrink: 0; /* Prevent shrinking in flex container */
        }
        .seat-class-option input[type="radio"]:checked {
            background-color: var(--color-primary-blue);
            border-color: var(--color-primary-blue);
            box-shadow: inset 0 0 0 4px white; /* Inner white circle */
        }
        .seat-class-option input[type="radio"]:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.5);
        }
        .seat-class-detail {
            color: var(--color-green-check);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .seat-class-detail svg {
            width: 1rem;
            height: 1rem;
        }

        /* Input Fields */
        .input-field {
            margin-top: 0.25rem; /* mt-1 */
            display: block; /* block */
            width: 100%; /* w-full */
            padding-left: 0.75rem; /* px-3 */
            padding-right: 0.75rem;
            padding-top: 0.5rem; /* py-2 */
            padding-bottom: 0.5rem;
            border: 1px solid #d1d5db; /* border-gray-300 */
            border-radius: 0.375rem; /* rounded-md */
            box-shadow: 0 1px 2px 0 rgba(0,0,0,0.05); /* shadow-sm */
        }
        .input-field:focus {
            outline: none; /* focus:outline-none */
            border-color: #3b82f6; /* focus:border-blue-500 */
            box-shadow: 0 0 0 3px rgba(59,130,246,0.5); /* focus:ring-blue-500 */
        }
        /* Dark input styling for date fields (reinstated as requested) */
        input[type="date"].dark-input {
            background-color: #1f2937; /* bg-gray-800 */
            color: #fff; /* text-white */
            border-color: #4b5563; /* border-gray-600 */
            filter: invert(100%); /* Helps make calendar icon white */
        }

        /* Moving Banner CSS (retained but styling adjusted for new design) */
        @keyframes scroll-x {
            from { transform: translateX(0); }
            to { transform: translateX(-50%); }
        }
        .scroll-container {
            overflow: hidden;
            width: 100%;
        }
        .scroll-content {
            display: flex;
            animation: scroll-x 20s linear infinite;
            animation-play-state: running;
        }
        .scroll-content:hover {
            animation-play-state: paused;
        }
        .scroll-item {
            flex: 0 0 auto;
            width: 280px; /* Adjusted width for more spacing in banner */
            margin-right: 24px;
        }
        /* Ensure card gradient classes override default scroll-item bg-white */
        .scroll-item.card {
            padding: 1.5rem; /* p-6 */
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06); /* shadow-lg */
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

    <header class="main-header text-white py-4 px-8 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <h1 id="travelEaseLogo" class="text-3xl font-bold cursor-pointer hover:text-blue-200 transition-colors duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" class="inline h-8 w-8 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                </svg>
                TravelEase
            </h1>
            <nav class="header-text-links text-sm font-semibold space-x-6">
                <a href="#" class="inline-flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                    </svg>
                    <span>24/7 Customer Support</span>
                </a>
                <a href="#" class="inline-flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                    </svg>
                    <span>Secure Payments</span>
                </a>
            </nav>
        </div>
    </header>

    <main class="flex-grow container mx-auto pb-8">

       <section class="gradient-bg-blue rounded-xl shadow-xl text-white py-16 px-8 mb-12 flex flex-col items-center justify-center text-center mt-10 relative z-10">

            <h2 class="text-5xl font-extrabold mb-4">TravelEase</h2>
            <p class="text-xl mb-8">Your Journey Starts Here - Effortless Flight Booking & Secure Payments</p>
            <div class="flex flex-wrap justify-center gap-8 text-lg font-semibold">
                <div class="flex flex-col items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                    </svg>
                    Secure Payments
                </div>
                <div class="flex flex-col items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
                    </svg>
                    Best Prices
                </div>
                <div class="flex flex-col items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                    </svg>
                    24/7 Support
                </div>
            </div>
        </section>

        <section id="homePage" class="current-page">
            <div class="card text-center mb-12">
                <h3 class="text-3xl font-semibold text-gray-800 mb-6">Find Your Perfect Flight</h3>
                <p class="text-md text-gray-600 mb-8">Choose your dates and discover amazing destinations</p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-xl mx-auto">
                    <div>
                        <label for="departureDate" class="block text-left text-gray-700 text-sm font-semibold mb-2">Departure Date</label>
                        <input type="date" id="departureDate" class="input-field px-4 py-3 border rounded-lg dark-input" placeholder="dd-mm-yyyy" required>
                    </div>
                    <div>
                        <label for="returnDate" class="block text-left text-gray-700 text-sm font-semibold mb-2">Return Date (Optional)</label>
                        <input type="date" id="returnDate" class="input-field px-4 py-3 border rounded-lg dark-input" placeholder="dd-mm-yyyy">
                    </div>
                </div>
                <button id="searchFlightsBtn" class="btn-blue-gradient mt-10 inline-flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                    <span>Search Flights</span>
                </button>
            </div>

            <div class="mt-12 text-center text-gray-700">
                <h3 class="text-3xl font-semibold mb-4">Featured Destinations</h3>
                <p class="text-md mb-8">Discover amazing places with our specially curated flight offers</p>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="destination-card gradient-card-purple">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mb-3 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M17.657 16.707V12A6 6 0 006 12v4.707m-4 0h16.5A2.5 2.5 0 0021 14.5V10.5a2.5 2.5 0 00-2.5-2.5H6.75a2.5 2.5 0 00-2.5 2.5v4A2.5 2.5 0 006.75 16h10.907z" />
                        </svg>
                        <h4 class="font-bold">New York</h4>
                        <p class="text-gray-200 text-sm">The city that never sleeps</p>
                        <p class="text-white text-xl font-extrabold mt-4">From ₹64,800</p>
                        <p class="text-gray-300 text-sm">Dates vary</p>
                    </div>
                    <div class="destination-card gradient-card-red">
                         <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mb-3 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" />
                        </svg>
                        <h4 class="font-bold">Paris</h4>
                        <p class="text-gray-200 text-sm">City of love and lights</p>
                        <p class="text-white text-xl font-extrabold mt-4">From ₹54,700</p>
                        <p class="text-gray-300 text-sm">Dates vary</p>
                    </div>
                    <div class="destination-card gradient-card-teal">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mb-3 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M17.657 16.707V12A6 6 0 006 12v4.707m-4 0h16.5A2.5 2.5 0 0021 14.5V10.5a2.5 2.5 0 00-2.5-2.5H6.75a2.5 2.5 0 00-2.5 2.5v4A2.5 2.5 0 006.75 16h10.907z" />
                        </svg>
                        <h4 class="font-bold">Tokyo</h4>
                        <p class="text-gray-200 text-sm">Modern meets traditional</p>
                        <p class="text-white text-xl font-extrabold mt-4">From ₹49,900</p>
                        <p class="text-gray-300 text-sm">Dates vary</p>
                    </div>
                    <div class="destination-card gradient-card-red">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mb-3 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9 9 0 009-9H3a9 9 0 009 9z" />
                        </svg>
                        <h4 class="font-bold">London</h4>
                        <p class="text-gray-200 text-sm">History and innovation</p>
                        <p class="text-white text-xl font-extrabold mt-4">From ₹44,500</p>
                        <p class="text-gray-300 text-sm">Dates vary</p>
                    </div>
                    <div class="destination-card gradient-card-teal">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mb-3 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M17.657 16.707V12A6 6 0 006 12v4.707m-4 0h16.5A2.5 2.5 0 0021 14.5V10.5a2.5 2.5 0 00-2.5-2.5H6.75a2.5 2.5 0 00-2.5 2.5v4A2.5 2.5 0 006.75 16h10.907z" />
                        </svg>
                        <h4 class="font-bold">Dubai</h4>
                        <p class="text-gray-200 text-sm">The city of gold</p>
                        <p class="text-white text-xl font-extrabold mt-4">From ₹14,800</p>
                        <p class="text-gray-300 text-sm">Dates vary</p>
                    </div>
                    <div class="destination-card gradient-card-purple">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mb-3 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5s3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18s-3.332.477-4.5 1.253" />
                        </svg>
                        <h4 class="font-bold">Goa, India</h4>
                        <p class="text-gray-200 text-sm">Sun, Sand, and Sea</p>
                        <p class="text-white text-xl font-extrabold mt-4">From ₹3,900</p>
                        <p class="text-gray-300 text-sm">Dates vary</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="resultsPage" class="hidden">
            <h3 class="text-3xl font-semibold text-gray-800 mb-6 text-center">Flights Available: <span id="resultsCount">0</span></h3>
            <div class="flex justify-center mb-8">
                <button id="modifySearchBtn" class="btn-modify-search">Modify Search</button>
            </div>
            <div id="flightList" class="space-y-4 max-w-4xl mx-auto">
                </div>
        </section>

        <section id="detailsPage" class="hidden">
            <h3 class="text-3xl font-semibold text-gray-800 mb-8 text-center">Complete Your Booking</h3>

            <div class="max-w-4xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1 p-6 bg-white rounded-xl shadow-lg h-fit sticky top-8">
                    <h4 class="text-xl font-bold text-gray-800 mb-4">Booking Summary</h4>
                    <p class="text-md font-semibold text-blue-600 mb-4" id="summaryFlightName"></p>
                    
                    <div class="space-y-2 text-gray-700 border-b pb-4 mb-4">
                        <div class="flex justify-between">
                            <span class="font-medium">Departure Date:</span>
                            <span id="summaryDepartureDate"></span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-medium">Return Date:</span>
                            <span id="summaryReturnDate"></span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-medium">Selected Class:</span>
                            <span id="summarySeatClass">Economy</span>
                        </div>
                    </div>

                    <div class="flex justify-between items-center text-lg font-bold text-gray-800 pt-4">
                        <span>Total Price:</span>
                        <span id="summaryFinalPrice" class="text-2xl text-red-600">₹0</span>
                    </div>
                </div>

                <div class="lg:col-span-2 space-y-8">
                    <div class="p-6 bg-white rounded-xl shadow-lg">
                        <h4 class="text-xl font-bold text-gray-800 mb-6 border-b pb-2">Passenger Details</h4>
                        <form id="passengerForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="fullName" class="block text-sm font-semibold text-gray-700">Full Name</label>
                                <input type="text" id="fullName" class="input-field" placeholder="John Doe" required>
                            </div>
                            <div>
                                <label for="email" class="block text-sm font-semibold text-gray-700">Email Address</label>
                                <input type="email" id="email" class="input-field" placeholder="john.doe@example.com" required>
                            </div>
                            <div>
                                <label for="phoneNumber" class="block text-sm font-semibold text-gray-700">Phone Number</label>
                                <input type="tel" id="phoneNumber" class="input-field" placeholder="+91 98765 43210" required>
                            </div>
                            <div>
                                <label for="nationality" class="block text-sm font-semibold text-gray-700">Nationality</label>
                                <input type="text" id="nationality" class="input-field" value="India" required>
                            </div>
                        </form>
                    </div>

                    <div class="p-6 bg-white rounded-xl shadow-lg">
                        <h4 class="text-xl font-bold text-gray-800 mb-6 border-b pb-2">Select Seat Class</h4>
                        <div id="seatClassOptions" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            </div>
                    </div>

                    <div class="p-6 bg-white rounded-xl shadow-lg">
                        <h4 class="text-xl font-bold text-gray-800 mb-6 border-b pb-2">Payment Details</h4>
                        <form id="paymentForm" class="space-y-4">
                            <div>
                                <label for="cardNumber" class="block text-sm font-semibold text-gray-700">Card Number (16 Digits)</label>
                                <input type="text" id="cardNumber" class="input-field" placeholder="XXXX XXXX XXXX XXXX" maxlength="16" required>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="expiryDate" class="block text-sm font-semibold text-gray-700">Expiry Date (MM/YY)</label>
                                    <input type="text" id="expiryDate" class="input-field" placeholder="01/25" maxlength="5" required>
                                </div>
                                <div>
                                    <label for="cvv" class="block text-sm font-semibold text-gray-700">CVV</label>
                                    <input type="password" id="cvv" class="input-field" placeholder="123" maxlength="3" required>
                                </div>
                            </div>
                        </form>
                    </div>

                    <div class="mt-8">
                        <div id="paymentStatus" class="p-4 rounded-lg font-bold mb-4 hidden"></div>
                        <button id="completeBookingBtn" class="btn-blue-gradient w-full py-4 text-xl flex items-center justify-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
                            </svg>
                            <span id="finalBookingText">Pay ₹0 and Complete Booking</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>


        <div id="loadingModal" class="fixed inset-0 bg-gray-900 bg-opacity-75 hidden flex items-center justify-center z-50">
            <div class="bg-white p-6 rounded-lg shadow-xl flex flex-col items-center">
                <svg class="animate-spin h-10 w-10 text-blue-600 mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <p id="loadingMessage" class="text-gray-700 font-semibold">Searching for flights...</p>
            </div>
        </div>

        <div id="bookingConfirmedModal" class="fixed inset-0 bg-gray-900 bg-opacity-75 hidden flex items-center justify-center z-50">
            <div class="bg-white p-8 rounded-xl shadow-2xl max-w-lg w-full text-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-20 w-20 text-green-500 mx-auto mb-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <h4 class="text-3xl font-bold text-gray-800 mb-4">Booking Confirmed!</h4>
                <p class="text-gray-600 mb-6">Your flight booking has been successfully confirmed. A detailed e-ticket has been sent to your email.</p>
                <div class="text-left bg-gray-100 p-4 rounded-lg mb-6">
                    <p class="font-semibold text-gray-700 mb-1">Transaction ID: <span id="confirmedTransactionId" class="font-normal text-blue-600"></span></p>
                    <p class="font-semibold text-gray-700">Total Paid: <span id="confirmedTotalPrice" class="font-normal text-red-600"></span></p>
                </div>
                <button id="goToHomeBtn" class="btn-blue-gradient">Start New Search</button>
            </div>
        </div>

    </main>

    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="container mx-auto px-8 text-center text-sm">
            &copy; 2024 TravelEase. All rights reserved. | <a href="#" class="hover:text-blue-400">Privacy Policy</a> | <a href="#" class="hover:text-blue-400">Terms of Service</a>
        </div>
    </footer>


    <script>
        // --- API Configuration ---
        const IS_LOCAL_MODE = true; // Set to true for local testing, false for cloud deployment
        const CLOUD_API_BASE_URL = "http://YOUR_ACTUAL_ALB_DNS_HERE"; // Replace with actual AWS ALB DNS

        // <<< FIX APPLIED HERE: This function now correctly routes paths to the right ports >>>
        function getApiUrl(path) {
            if (IS_LOCAL_MODE) {
                // Determine the port based on the path prefix
                if (path.startsWith('/api/search')) {
                    return `http://127.0.0.1:5002${path}`; // Flight Service (5002)
                } else if (path.startsWith('/api/payment')) {
                    return `http://127.0.0.1:5003${path}`; // Payment Service (5003) <-- FIXED PORT
                } else if (path.startsWith('/book')) {
                    return `http://127.0.0.1:5000${path}`; // Booking Service (5000)
                }
            }
            // Cloud mode or fallback (uses the single ALB DNS)
            return `${CLOUD_API_BASE_URL}${path}`;
        }
        
        // --- Global State ---
        let selectedFlight = '';
        let selectedFlightPrice = 0;
        let selectedSeatClass = 'Economy'; // Default seat class
        let departureDate = '';
        let returnDate = '';
        let finalBookingPrice = 0; 
        
        // --- DOM Elements ---
        const homePage = document.getElementById('homePage');
        const resultsPage = document.getElementById('resultsPage');
        const detailsPage = document.getElementById('detailsPage');
        const loadingModal = document.getElementById('loadingModal');
        const bookingConfirmedModal = document.getElementById('bookingConfirmedModal');

        // --- Event Listeners ---
        document.getElementById('travelEaseLogo').addEventListener('click', () => {
            showPage(homePage);
            clearAllFormData();
        });
        document.getElementById('searchFlightsBtn').addEventListener('click', searchFlights);
        document.getElementById('modifySearchBtn').addEventListener('click', () => showPage(homePage));
        document.getElementById('completeBookingBtn').addEventListener('click', completePayment);
        
        // --- Core Functions ---

        function showPage(pageToShow) {
            [homePage, resultsPage, detailsPage].forEach(page => {
                page.classList.add('hidden');
            });
            pageToShow.classList.remove('hidden');
            window.scrollTo(0, 0); // Scroll to top on page change
        }

        function showLoading(message) {
            document.getElementById('loadingMessage').textContent = message;
            loadingModal.classList.remove('hidden');
        }

        function hideLoading() {
            loadingModal.classList.add('hidden');
        }

        function getSeatClassPrice(basePrice, seatClass) {
            switch(seatClass) {
                case 'Business': return basePrice + 15000;
                case 'First': return basePrice + 35000;
                case 'Economy':
                default: return basePrice;
            }
        }

        function updateSummary() {
            const basePrice = selectedFlightPrice;
            finalBookingPrice = getSeatClassPrice(basePrice, selectedSeatClass);

            document.getElementById('summaryFlightName').textContent = selectedFlight || 'N/A';
            document.getElementById('summaryDepartureDate').textContent = departureDate || 'N/A';
            document.getElementById('summaryReturnDate').textContent = returnDate || 'One Way';
            document.getElementById('summarySeatClass').textContent = selectedSeatClass;
            document.getElementById('summaryFinalPrice').textContent = `₹${finalBookingPrice.toLocaleString('en-IN')}`;
            document.getElementById('finalBookingText').textContent = `Pay ₹${finalBookingPrice.toLocaleString('en-IN')} and Complete Booking`;

            // Update radio button prices
            document.querySelectorAll('.seat-class-option').forEach(option => {
                const radio = option.querySelector('input[name="seatClass"]');
                const priceSpan = option.querySelector('.seat-price');
                if (radio && priceSpan) {
                    const classType = radio.value;
                    const classPrice = getSeatClassPrice(basePrice, classType);
                    priceSpan.textContent = `₹${classPrice.toLocaleString('en-IN')}`;
                }
            });
        }
        
        function selectFlight(flightName, price) {
            selectedFlight = flightName;
            selectedFlightPrice = price;
            // Reset to default class when new flight is selected
            selectedSeatClass = 'Economy'; 
            
            // Populate seat class options dynamically (assuming static data here, but can be dynamic)
            const seatClassOptions = document.getElementById('seatClassOptions');
            seatClassOptions.innerHTML = `
                <label class="seat-class-option" onclick="document.getElementById('classEconomy').checked = true; updateSeatClass('Economy')">
                    <input type="radio" name="seatClass" id="classEconomy" value="Economy" checked>
                    <div>
                        <p class="font-bold text-gray-800">Economy Class</p>
                        <p class="text-sm text-gray-600">Standard seating with essential services.</p>
                        <div class="seat-class-detail">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
                            <span class="seat-price font-extrabold">₹0</span>
                        </div>
                    </div>
                </label>
                <label class="seat-class-option" onclick="document.getElementById('classBusiness').checked = true; updateSeatClass('Business')">
                    <input type="radio" name="seatClass" id="classBusiness" value="Business">
                    <div>
                        <p class="font-bold text-gray-800">Business Class</p>
                        <p class="text-sm text-gray-600">Wider seats, priority boarding, and premium meals.</p>
                        <div class="seat-class-detail">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
                            <span class="seat-price font-extrabold">₹0</span>
                        </div>
                    </div>
                </label>
                <label class="seat-class-option" onclick="document.getElementById('classFirst').checked = true; updateSeatClass('First')">
                    <input type="radio" name="seatClass" id="classFirst" value="First">
                    <div>
                        <p class="font-bold text-gray-800">First Class</p>
                        <p class="text-sm text-gray-600">Ultimate comfort, private suites, and gourmet dining.</p>
                        <div class="seat-class-detail">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
                            <span class="seat-price font-extrabold">₹0</span>
                        </div>
                    </div>
                </label>
            `;

            updateSummary(); // Initial summary update
            showPage(detailsPage);
        }

        function updateSeatClass(classType) {
            selectedSeatClass = classType;
            updateSummary();
        }

        // --- API Calls ---
        async function searchFlights() {
            departureDate = document.getElementById('departureDate').value;
            returnDate = document.getElementById('returnDate').value;
            
            if (!departureDate) {
                alert("Please select a departure date.");
                return;
            }

            const searchParams = new URLSearchParams({ 
                departure: 'DEL', 
                arrival: 'BOM', 
                date: departureDate 
            });

            showLoading('Searching for flights (Flight Service 5002)...');

            try {
                // Call Flight Search Microservice (Port 5002)
                const searchResponse = await fetch(getApiUrl('/api/search') + '?' + searchParams.toString());
                
                if (!searchResponse.ok) {
                    throw new Error(`HTTP error! status: ${searchResponse.status}`);
                }

                const data = await searchResponse.json();
                
                // Simulate results display based on dummy data
                const flights = [
                    { name: "Air India AI-345", price: 12500, departure: "09:00", arrival: "11:00", duration: "2h 0m" },
                    { name: "IndiGo 6E-789", price: 10800, departure: "14:30", arrival: "16:45", duration: "2h 15m" },
                    { name: "Vistara UK-901", price: 14200, departure: "20:00", arrival: "22:10", duration: "2h 10m" },
                    { name: "SpiceJet SG-123", price: 9500, departure: "06:00", arrival: "08:00", duration: "2h 0m" }
                ];

                renderFlights(flights);

            } catch (error) {
                alert(`Flight search failed! Please ensure Flight Service (Port 5002) is running. Error: ${error.message}`);
                console.error("Flight search error:", error);
                renderFlights([]);
            } finally {
                hideLoading();
            }
        }

        async function completePayment() {
            // 1. Validate Passenger Details
            if (!document.getElementById('passengerForm').reportValidity()) {
                alert("Please fill in all passenger details.");
                return;
            }

            // 2. Validate Payment Details
            if (!document.getElementById('paymentForm').reportValidity()) {
                alert("Please fill in all payment details.");
                return;
            }

            const cardNumber = document.getElementById('cardNumber').value;
            const passengerName = document.getElementById('fullName').value;
            const paymentStatusElement = document.getElementById('paymentStatus');
            
            if (finalBookingPrice <= 0) {
                 alert("Invalid price for booking.");
                return;
            }

            showLoading('Processing payment (Payment Service 5003)...');

            try {
                // Call Payment Microservice (Port 5003)
                const paymentResponse = await fetch(getApiUrl('/api/payment'), {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        card_number: cardNumber,
                        amount: finalBookingPrice,
                        name: passengerName
                    })
                });

                const paymentData = await paymentResponse.json();

                if (!paymentResponse.ok) {
                    paymentStatusElement.textContent = `Payment Failed: ${paymentData.message}`;
                    paymentStatusElement.className = 'p-4 bg-red-100 text-red-700 rounded-lg font-bold mb-4';
                    paymentStatusElement.classList.remove('hidden');
                    throw new Error(paymentData.message || `Payment service error with status: ${paymentResponse.status}`);
                }

                // Payment Success: Now proceed to Booking
                paymentStatusElement.textContent = paymentData.message; // "Payment successful!"
                paymentStatusElement.className = 'p-4 bg-green-100 text-green-700 rounded-lg font-bold mb-4';
                paymentStatusElement.classList.remove('hidden');

                const transactionId = paymentData.transaction_id;

                await finalizeBooking(transactionId);


            } catch (error) {
                // Error handled inside the function, just hide loading
                console.error("Payment flow failed:", error);
            } finally {
                hideLoading();
            }
        }


        async function finalizeBooking(transactionId) {
            showLoading('Finalizing booking (Booking Service 5000)...');

            try {
                // Call Booking Microservice (Port 5000)
                const bookingResponse = await fetch(getApiUrl('/book'), {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        flight: selectedFlight,
                        price: finalBookingPrice,
                        class: selectedSeatClass,
                        transaction_id: transactionId
                    })
                });
                
                const bookingData = await bookingResponse.json();
                
                if (!bookingResponse.ok) {
                    throw new Error(bookingData.message || `Booking service error with status: ${bookingResponse.status}`);
                }

                // Final Success: Show Confirmation Modal
                document.getElementById('confirmedTransactionId').textContent = transactionId;
                document.getElementById('confirmedTotalPrice').textContent = `₹${finalBookingPrice.toLocaleString('en-IN')}`;
                bookingConfirmedModal.classList.remove('hidden');
                
            } catch (error) {
                 alert(`Booking Failed! Please ensure Booking Service (Port 5000) is running. Error: ${error.message}`);
                 console.error("Booking error:", error);
            } finally {
                hideLoading();
            }
        }


        // --- Rendering Functions ---
        function renderFlights(flights) {
            const flightList = document.getElementById('flightList');
            flightList.innerHTML = '';
            document.getElementById('resultsCount').textContent = flights.length;

            if (flights.length === 0) {
                flightList.innerHTML = `<div class="p-6 bg-yellow-100 text-yellow-700 rounded-lg shadow-lg text-center font-semibold">No flights found for the selected date. Please modify your search.</div>`;
                showPage(resultsPage);
                return;
            }

            flights.forEach(flight => {
                const flightItem = document.createElement('div');
                flightItem.className = 'flight-item-card hover:shadow-xl transition-shadow duration-300';
                flightItem.innerHTML = `
                    <div class="flex items-center space-x-6 w-full md:w-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                        </svg>
                        <div>
                            <p class="font-bold text-lg text-gray-900">${flight.name}</p>
                            <p class="text-sm text-gray-600">${flight.departure} - ${flight.arrival} (${flight.duration})</p>
                        </div>
                    </div>
                    
                    <div class="mt-4 md:mt-0 flex items-center justify-between w-full md:w-auto md:space-x-8">
                        <div class="text-center">
                            <p class="text-xs text-gray-500 font-medium">Starting Price</p>
                            <p class="text-2xl font-extrabold text-red-600">₹${flight.price.toLocaleString('en-IN')}</p>
                        </div>
                        <button class="btn-blue-gradient py-2 px-6" onclick="selectFlight('${flight.name}', ${flight.price})">
                            Book Now
                        </button>
                    </div>
                `;
                flightList.appendChild(flightItem);
            });

            showPage(resultsPage);
        }

        // --- Booking Confirmed Modal Logic ---
        document.getElementById('goToHomeBtn').addEventListener('click', () => {
            bookingConfirmedModal.classList.add('hidden');
            showPage(homePage);
            clearAllFormData();
        });

        // Helper function to clear form data
        function clearAllFormData() {
            document.getElementById('departureDate').value = '';
            document.getElementById('returnDate').value = '';
            document.getElementById('fullName').value = '';
            document.getElementById('email').value = '';
            document.getElementById('phoneNumber').value = '';
            document.getElementById('cardNumber').value = '';
            document.getElementById('expiryDate').value = '';
            document.getElementById('cvv').value = '';
            
            const economyRadio = document.querySelector('input[name="seatClass"][value="Economy"]'); 
            if (economyRadio) economyRadio.checked = true;
            
            const otherRadios = document.querySelectorAll('input[name="seatClass"]:not([value="Economy"])'); 
            otherRadios.forEach(radio => radio.checked = false);

            selectedFlight = '';
            selectedFlightPrice = 0;
            selectedSeatClass = 'Economy';
            departureDate = '';
            returnDate = '';
            finalBookingPrice = 0;

            const paymentStatusElement = document.getElementById('paymentStatus');
            paymentStatusElement.classList.add('hidden');
            paymentStatusElement.textContent = '';
        }
    </script>
</body>
</html>
"use strict";(self.webpackChunkgrafana_metricsdrilldown_app=self.webpackChunkgrafana_metricsdrilldown_app||[]).push([[601],{2601:(e,t,r)=>{r.r(t),r.d(t,{calculateOutlierValue:()=>p,sortSeries:()=>c,sortSeriesByName:()=>v,wasmSupported:()=>b});var n=r(6944),o=r(7781),l=r(3241),s=r(2445),a=r(3347),i=r(5570);const c=(0,l.memoize)((e,t,r="asc")=>{if("alphabetical"===t)return v(e,"asc");if("alphabetical-reversed"===t)return v(e,"desc");"outliers"===t&&f(e);const n=r=>{var n;try{if("outliers"===t)return p(e,r)}catch(e){s.v.error(e,{message:"ML sorting panicked, fallback to stdDev"}),t=o.ReducerID.stdDev}const l=o.fieldReducers.get(t);var a;var i;return null!==(i=(null!==(a=null===(n=l.reduce)||void 0===n?void 0:n.call(l,r.fields[1],!0,!0))&&void 0!==a?a:(0,o.doStandardCalcs)(r.fields[1],!0,!0))[t])&&void 0!==i?i:0},l=e.map(e=>({value:n(e),dataFrame:e}));return l.sort((e,t)=>void 0!==e.value&&void 0!==t.value?t.value-e.value:0),"asc"===r&&l.reverse(),l.map(({dataFrame:e})=>e)},(e,t,r="asc")=>{const n=u(e)?e[0].fields[0].values[0]:0,o=u(e)?e[e.length-1].fields[0].values[e[e.length-1].fields[0].values.length-1]:0;return`${e.length>0?(0,i.H)(e[0]):""}_${e.length>0?(0,i.H)(e[e.length-1]):""}_${n}_${o}_${e.length}_${t}_${r}`});function u(e){return e.length>0&&e[0].fields.length>0&&e[0].fields[0].values.length>0}const f=e=>{if(!b())return;const t=(0,o.outerJoinDataFrames)({frames:e});if(!t)return;const r=t.fields.filter(e=>e.type===o.FieldType.number).map(e=>new Float64Array(e.values));try{const e=n.OutlierDetector.dbscan({sensitivity:.4}).preprocess(r);d=e.detect()}catch(e){s.v.error(e,{message:"Error initializing outlier detector"}),d=void 0}};let d;const p=(e,t)=>{if(!b())throw new Error("WASM not supported, fall back to stdDev");if(!d)throw new Error("Initialize outlier detector first");const r=e.indexOf(t);return d.seriesResults[r].isOutlier?-d.seriesResults[r].outlierIntervals.length:0},v=(e,t)=>{const r=[...e];return r.sort((e,t)=>{const r=(0,i.H)(e),n=(0,i.H)(t);return r&&n&&null!==(o=null==r?void 0:r.localeCompare(n))&&void 0!==o?o:0;var o}),"desc"===t&&r.reverse(),r},b=()=>{const e="object"==typeof WebAssembly;return e||(0,a.z)("wasm_not_supported",{}),e}},3347:(e,t,r)=>{r.d(t,{h:()=>f,z:()=>c});var n=r(8531),o=r(4137),l=r(5176);function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}const i="grafana_explore_metrics_";function c(e,t){(0,n.reportInteraction)(`${i}${e}`,a(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){s(e,t,r[t])})}return e}({},t),{meta:{appRelease:n.config.apps[o.s_].version,appVersion:l.t}}))}function u(e,t){c("label_filter_changed",{label:e,action:t,cause:"adhoc_filter"})}function f(e,t){e.length===t.length?function(e,t){for(const r of t)for(const t of e)r.key===t.key&&r.value!==t.value&&u(r.key,"changed")}(e,t):e.length<t.length?function(e,t){for(const r of t)e.some(e=>e.key===r.key)||u(r.key,"removed")}(e,t):function(e,t){for(const r of e)!t.some(e=>e.key===r.key)&&u(r.key,"added")}(e,t)}},5570:(e,t,r)=>{function n(e){var t;const r=null===(t=e.fields[1])||void 0===t?void 0:t.labels;if(!r)return null;const n=Object.keys(r);return 0===n.length?null:r[n[0]]}r.d(t,{H:()=>n})}}]);
//# sourceMappingURL=601.js.map?_cache=76563d0270f6c18ca444